//
//  SyncHelper.h
//  ChinaBrowser
//
//  Created by David on 14/12/19.
//  Copyright (c) 2014年 KOTO Inc. All rights reserved.
//

#import <Foundation/Foundation.h>

typedef void (^SyncCompletion) ();
typedef void (^SyncAddCompletion) (NSArray *arrPkidServer);
typedef void (^SyncGetCompletion) (NSArray *arrModel);
typedef void (^SyncGetUserSettingsCompletion) (ModelUserSettings *modelUserSettings);
typedef void (^SyncFail) (NSError *error);

@class ModelUserSettings;
@class ModelHistory;
@class ModelBookmark;
@class ModelMode;
@class ModelModeProgram;

/**
 *  同步助手，同步用户设置、书签、最近浏览、个性化定制；其中用户设置是及时同步的，修改用户设置则立即反馈到服务器，忽略失败的操作
 *  提交失败后
 */
@interface SyncHelper : NSObject

/**
 *
 */
@property (nonatomic, assign) BOOL isSyncing;

+ (instancetype)shareSync;

/**
 *  根据用户设置同步所有能同步的数据
 *
 *  @param completion completion description
 *  @param fail       fail description
 */
- (void)syncAllIfNeededWithCompletion:(SyncCompletion)completion fail:(SyncFail)fail;

// --------------------- 批处理 get=>compare=>submit
/**
 *  同步用户设置
 *
 *  @param completion completion description
 *  @param fail       fail description
 */
- (void)syncUserSettingsWithCompletion:(SyncCompletion)completion fail:(SyncFail)fail;

/**
 *  同步最近浏览
 *
 *  @param completion completion description
 *  @param fail       fail description
 */
- (void)syncHistoryWithCompletion:(SyncCompletion)completion fail:(SyncFail)fail;

/**
 *  同步书签
 *
 *  @param completion completion description
 *  @param fail       fail description
 */
- (void)syncBookmarkWithCompletion:(SyncCompletion)completion fail:(SyncFail)fail;

/**
 *  同步定制提醒(个性化定制)
 *
 *  @param completion completion description
 *  @param fail       fail description
 */
- (void)syncReminderWithCompletion:(SyncCompletion)completion fail:(SyncFail)fail;

// --------------------- 批处理同步 submit
- (void)synAddModelHistory:(ModelHistory *)modelHistory completion:(SyncAddCompletion)completion fail:(SyncFail)fail;

- (void)synAddModelBookmark:(ModelBookmark *)modelBookmark completion:(SyncAddCompletion)completion fail:(SyncFail)fail;

- (void)synAddModelMode:(ModelMode *)modelMode completion:(SyncAddCompletion)completion fail:(SyncFail)fail;

- (void)synAddModelModeProgram:(ModelModeProgram *)modelMode completion:(SyncAddCompletion)completion fail:(SyncFail)fail;

// --------------------- 批处理同步 delete
- (void)syncDeleteHistoryWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncDeleteBookmarkWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncDeleteModeWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncDeleteModeProgramWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

// --------------------- 单条同步 update
- (void)syncUpdateUserSettingCompletion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncUpdateHistoryWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncUpdateBookmarkWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncUpdateModeWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

- (void)syncUpdateModeProgramWithPkidServer:(NSInteger)pkidServer completion:(SyncCompletion)completion fail:(SyncFail)fail;

// --------------------- 同步 get
- (void)syncGetUserSettingsWithCompletion:(SyncGetUserSettingsCompletion)completion fail:(SyncFail)fail;

- (void)syncGetHistoryWithCompletion:(SyncGetCompletion)completion fail:(SyncFail)fail;

- (void)syncGetBookmarkWithCompletion:(SyncGetCompletion)completion fail:(SyncFail)fail;

- (void)syncGetModeWithCompletion:(SyncGetCompletion)completion fail:(SyncFail)fail;

- (void)syncGetModeProgramWithCompletion:(SyncGetCompletion)completion fail:(SyncFail)fail;

@end
